(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{403:(e,t,r)=>{Promise.resolve().then(r.bind(r,9809))},9809:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>R});var a,s,l,n=r(5155),i=r(2115),o=r(2818);let d=(null!==(a=o.env.NEXT_PUBLIC_R2_BASE_URL)&&void 0!==a?a:"").trim().replace(/\/+$/,""),c=(null!==(s=o.env.NEXT_PUBLIC_ADMIN_USERNAME)&&void 0!==s?s:"admin").trim(),x=(null!==(l=o.env.NEXT_PUBLIC_ADMIN_PASSWORD)&&void 0!==l?l:"admin").trim(),m=e=>{if(!e||!d)return"";try{let t=new URL(d+"/");if(e.startsWith("http")){let r=new URL(e);return new URL("".concat(r.pathname).concat(r.search).concat(r.hash),t).toString()}return new URL(e,t).toString()}catch(e){return""}},h=(e,t)=>{if(!e)return"";let r=new URLSearchParams;return r.set("path",e),t&&r.set("filename",t),"/api/download?".concat(r.toString())},g=(e,t)=>{let r=e.toLowerCase();return"folder"===t?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-yellow-400",fill:"currentColor",children:(0,n.jsx)("path",{d:"M19.5 21a3 3 0 0 0 3-3v-4.5a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3V18a3 3 0 0 0 3 3h15ZM1.5 10.146V6a3 3 0 0 1 3-3h5.379a2.25 2.25 0 0 1 1.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 0 1 3 3v1.146A4.483 4.483 0 0 0 19.5 9h-15a4.483 4.483 0 0 0-3 1.146Z"})}):t.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|svg|bmp|ico|tiff)$/i.test(r)?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-purple-500",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z",clipRule:"evenodd"})}):t.startsWith("video/")||/\.(mp4|webm|ogg|mov|mkv|avi|m4v)$/i.test(r)?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-rose-500",fill:"currentColor",children:(0,n.jsx)("path",{d:"M4.5 4.5a3 3 0 0 0-3 3v9a3 3 0 0 0 3 3h8.25a3 3 0 0 0 3-3v-9a3 3 0 0 0-3-3H4.5ZM19.94 18.75l-2.69-2.69V7.94l2.69-2.69c.944-.945 2.56-.276 2.56 1.06v11.38c0 1.336-1.616 2.005-2.56 1.06Z"})}):t.startsWith("audio/")||/\.(mp3|wav|ogg|m4a|flac|aac|wma)$/i.test(r)?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-cyan-500",fill:"currentColor",children:(0,n.jsx)("path",{d:"M21 3L9 5.5v10.03a3.5 3.5 0 1 0 2 3V8.41l8-1.66v7.78a3.5 3.5 0 1 0 2 3V3z"})}):"application/pdf"===t||r.endsWith(".pdf")?(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-red-500",fill:"currentColor",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,n.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):t.includes("sheet")||t.includes("excel")||/\.(xlsx|xls|csv)$/i.test(r)?(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-green-600",fill:"currentColor",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,n.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):t.includes("presentation")||t.includes("powerpoint")||/\.(pptx|ppt)$/i.test(r)?(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-orange-500",fill:"currentColor",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,n.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):t.includes("word")||t.includes("document")||/\.(docx|doc)$/i.test(r)?(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-blue-600",fill:"currentColor",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,n.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"}),(0,n.jsx)("text",{x:"8",y:"18",fontSize:"6",fill:"white",fontWeight:"bold",children:"W"})]}):t.includes("zip")||t.includes("compressed")||/\.(zip|rar|7z|tar|gz|bz2)$/i.test(r)?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-gray-500",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M6 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3H6Zm1.5 1.5a.75.75 0 0 0-.75.75v1.5a.75.75 0 0 0 .75.75h1.5a.75.75 0 0 0 .75-.75v-1.5a.75.75 0 0 0-.75-.75h-1.5ZM6 9.75A.75.75 0 0 1 6.75 9h1.5a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1-.75-.75v-1.5Zm.75 3.75a.75.75 0 0 0-.75.75v1.5a.75.75 0 0 0 .75.75h1.5a.75.75 0 0 0 .75-.75v-1.5a.75.75 0 0 0-.75-.75h-1.5Z",clipRule:"evenodd"})}):/\.(html|css|js|jsx|ts|tsx|json|java|py|go|c|cpp|h|cs|php|rb|sh|bat|cmd|xml|yaml|yml|sql|rs|swift|kt)$/i.test(r)?(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-indigo-500",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M14.447 3.026a.75.75 0 0 1 .527.921l-4.5 16.5a.75.75 0 0 1-1.448-.394l4.5-16.5a.75.75 0 0 1 .921-.527ZM16.72 6.22a.75.75 0 0 1 1.06 0l5.25 5.25a.75.75 0 0 1 0 1.06l-5.25 5.25a.75.75 0 1 1-1.06-1.06L21.44 12l-4.72-4.72a.75.75 0 0 1 0-1.06Zm-9.44 0a.75.75 0 0 1 0 1.06L2.56 12l4.72 4.72a.75.75 0 0 1-1.06 1.06L.97 12.53a.75.75 0 0 1 0-1.06l5.25-5.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"})}):t.startsWith("text/")||/\.(txt|md|markdown|log|ini|conf)$/i.test(r)?(0,n.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-slate-500",fill:"currentColor",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,n.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):(0,n.jsx)("svg",{viewBox:"0 0 24 24",className:"h-8 w-8 text-gray-400",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 0 1-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.271 1.513 3.374 0 4.646l-2.114 1.84a.75.75 0 0 1-1.004-1.114l2.114-1.84c.89-.777.89-2.096 0-2.803Zm-4.243 9.045a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"})})},u=(e,t)=>{let r=e.toLowerCase();return"folder"===t?{label:"文件夹",tone:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"}:t.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|svg|bmp|ico|tiff)$/i.test(r)?{label:"图片",tone:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300"}:t.startsWith("video/")||/\.(mp4|webm|ogg|mov|mkv|avi|m4v)$/i.test(r)?{label:"视频",tone:"bg-rose-100 text-rose-800 dark:bg-rose-900/30 dark:text-rose-300"}:t.startsWith("audio/")||/\.(mp3|wav|ogg|m4a|flac|aac|wma)$/i.test(r)?{label:"音频",tone:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/30 dark:text-cyan-300"}:"application/pdf"===t||r.endsWith(".pdf")?{label:"PDF",tone:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}:t.includes("sheet")||t.includes("excel")||/\.(xlsx|xls|csv)$/i.test(r)?{label:"Excel",tone:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}:t.includes("presentation")||t.includes("powerpoint")||/\.(pptx|ppt)$/i.test(r)?{label:"PPT",tone:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"}:t.includes("word")||t.includes("document")||/\.(docx|doc)$/i.test(r)?{label:"Word",tone:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}:t.includes("zip")||t.includes("compressed")||/\.(zip|rar|7z|tar|gz|bz2)$/i.test(r)?{label:"压缩包",tone:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}:/\.(html|css|js|jsx|ts|tsx|json|java|py|go|c|cpp|h|cs|php|rb|sh|bat|cmd|xml|yaml|yml|sql|rs|swift|kt)$/i.test(r)?{label:"代码",tone:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300"}:t.startsWith("text/")||/\.(txt|md|markdown|log|ini|conf)$/i.test(r)?{label:"文本",tone:"bg-slate-100 text-slate-800 dark:bg-slate-900/30 dark:text-slate-300"}:{label:"未知",tone:"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},p=e=>null==e?"-":e>1048576?(e/1024/1024).toFixed(2)+" MB":e>1024?(e/1024).toFixed(2)+" KB":e+" B",f=e=>new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(e)),b=e=>{navigator.clipboard.writeText(e)},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];for(let s of e){var a;let e=[...t,s.name];r.push({item:s,parentPath:t,fullPath:e}),"folder"===s.type&&(null===(a=s.children)||void 0===a?void 0:a.length)&&r.push(...v(s.children,e))}return r},y=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"})})},k=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})})},j=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})})},w=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})})},N=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),(0,n.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})},C=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,n.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})},L=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})},M=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),(0,n.jsx)("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),(0,n.jsx)("path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),(0,n.jsx)("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]})},A=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M15.75 5.25v13.5m-7.5-13.5v13.5"})})},B=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})})},W=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})})},Z=e=>{let{className:t}=e;return(0,n.jsx)("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M6 18L18 6M6 6l12 12"})})},R=()=>{let[e,t]=(0,i.useState)([]),[r,a]=(0,i.useState)([]),[s,l]=(0,i.useState)([]),[o,d]=(0,i.useState)(null),[R,S]=(0,i.useState)(null),[z,_]=(0,i.useState)(""),[E,H]=(0,i.useState)(null),[V,$]=(0,i.useState)([]),[P,D]=(0,i.useState)(!1),[T,U]=(0,i.useState)(!1),[I,F]=(0,i.useState)(!1),[O,q]=(0,i.useState)(""),[X,G]=(0,i.useState)(""),[Q,J]=(0,i.useState)(!1),[K,Y]=(0,i.useState)(""),[ee,et]=(0,i.useState)(!1),[er,ea]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=localStorage.getItem("r2_username");e&&(J(!0),q(e))},[]);let[es,el]=(0,i.useState)({key:"lastModified",direction:"desc"}),en=(0,i.useRef)(null),ei=(0,i.useRef)(new Map),eo=async()=>{try{let e=await fetch("/api/files",{cache:"no-store"});if(!e.ok){let t=await e.text();throw Error("API请求失败: ".concat(e.status," ").concat(t.slice(0,100)))}let r=await e.json();if(!Array.isArray(r))throw Error("返回数据格式错误，应为数组");t(r)}catch(t){let e=t instanceof Error?t.message:String(t);H("加载失败: ".concat(e)),console.error(t)}};(0,i.useEffect)(()=>{eo()},[]),(0,i.useEffect)(()=>{if(E){if(E.includes("失败")||E.includes("Error"))return;let e=setTimeout(()=>H(null),3e3);return()=>clearTimeout(e)}},[E]),(0,i.useEffect)(()=>{let e=()=>U(!0);return window.addEventListener("trigger-upload",e),()=>window.removeEventListener("trigger-upload",e)},[]),(0,i.useEffect)(()=>{let e=()=>l([]);return window.addEventListener("navigate-home",e),()=>window.removeEventListener("navigate-home",e)},[]),(0,i.useEffect)(()=>{let t=e;for(let e of s){let r=t.find(t=>"folder"===t.type&&t.name===e);if(r&&r.children)t=r.children;else{t=[];break}}a(t)},[s,e]);let ed=(0,i.useMemo)(()=>[...r].sort((e,t)=>{let r="folder"===e.type;if(r!==("folder"===t.type))return r?-1:1;let a=0;switch(es.key){case"name":a=e.name.localeCompare(t.name,"zh-CN",{numeric:!0});break;case"size":a=(e.size||0)-(t.size||0);break;case"lastModified":a=new Date(e.lastModified).getTime()-new Date(t.lastModified).getTime()}return"asc"===es.direction?a:-a}),[r,es]),ec=z.trim().toLowerCase(),ex=(0,i.useMemo)(()=>ec?v(e).filter(e=>e.item.name.toLowerCase().includes(ec)):null,[ec,e]),em=(0,i.useMemo)(()=>ex||ed.map(e=>({item:e,parentPath:s,fullPath:[...s,e.name]})),[ed,s,ex]),eh=e=>{b(e),S(e),H("链接已复制成功 ✅"),setTimeout(()=>S(null),2e3)},eg=e=>{if("folder"!==e.type){if(!e.url){H("当前文件没有可访问的 URL，无法预览。请在 Cloudflare Pages 环境变量中配置 NEXT_PUBLIC_R2_BASE_URL。");return}d(e)}},eu=()=>d(null),ep=e=>{l([...s,e.name])},ef=e=>{l(s.slice(0,e+1))},eb=(0,i.useCallback)(async e=>{$(t=>t.map(t=>t.id===e.id?{...t,status:"uploading"}:t));try{let t=await fetch("/api/upload",{method:"POST",body:JSON.stringify({filename:e.key,contentType:e.file.type})});if(!t.ok)throw Error("无法获取上传签名");let{url:r}=await t.json();return new Promise((t,a)=>{let s=new XMLHttpRequest;ei.current.set(e.id,s);let l=0,n=Date.now();s.open("PUT",r),s.setRequestHeader("Content-Type",e.file.type),s.upload.onprogress=t=>{if(t.lengthComputable){let r=Date.now(),a=r-n,s=t.loaded/t.total*100,i=e.speed;if(a>=500){let e=t.loaded-l;i=p(e/a*1e3)+"/s",l=t.loaded,n=r}$(e=>e.map(e=>e.id==e.id?{...e,progress:s,speed:i}:e))}},s.onload=()=>{ei.current.delete(e.id),s.status>=200&&s.status<300?($(t=>t.map(t=>t.id===e.id?{...t,status:"success",progress:100,speed:""}:t)),eo(),t()):a(Error("Upload failed: ".concat(s.statusText)))},s.onerror=()=>{ei.current.delete(e.id),a(Error("网络错误 (请检查 R2 CORS 配置)"))},s.onabort=()=>{ei.current.delete(e.id),a(Error("已取消"))},s.send(e.file)})}catch(r){console.error(r);let t=r instanceof Error?r.message:String(r);$(r=>r.map(r=>r.id===e.id&&"paused"!==r.status?{...r,status:"error",error:t}:r))}},[]);(0,i.useEffect)(()=>{if(V.filter(e=>"uploading"===e.status).length<1){let e=V.find(e=>"pending"===e.status);e&&eb(e)}},[V,eb]);let ev=e=>{let t=ei.current.get(e);t&&t.abort(),$(t=>t.map(t=>t.id===e?{...t,status:"paused"}:t))},ey=e=>{$(t=>t.map(t=>t.id===e?{...t,status:"pending",error:void 0}:t))},ek=e=>{let t=ei.current.get(e);t&&t.abort(),$(t=>t.filter(t=>t.id!==e))},ej=(e,t)=>{el({key:e,direction:t}),F(!1)},ew=async e=>{let t=e.target.files;t&&0!==t.length&&(eN(Array.from(t)),en.current&&(en.current.value=""))},eN=async e=>{let t=s.length>0?s.join("/")+"/":"",r=e.map(e=>({id:Math.random().toString(36).substring(2,9),file:e,key:t+e.name,progress:0,speed:"0 B/s",status:"pending"}));$(e=>[...e,...r]),U(!0)};return(0,n.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100 transition-colors relative",children:[(0,n.jsxs)("div",{className:"flex-1 w-full mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[(0,n.jsxs)("nav",{className:"flex items-center text-sm font-medium text-gray-500 dark:text-gray-400 overflow-x-auto whitespace-nowrap pb-2 md:pb-0",children:[(0,n.jsxs)("button",{onClick:()=>l([]),className:"hover:text-blue-600 dark:hover:text-blue-400 transition-colors flex items-center gap-1",children:[(0,n.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"根目录"]}),s.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"h-5 w-5 text-gray-400 mx-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsx)("button",{onClick:()=>ef(t),className:"hover:text-blue-600 dark:hover:text-blue-400 transition-colors ".concat(t===s.length-1?"text-gray-900 dark:text-white font-semibold":""),children:e})]},t))]}),(0,n.jsxs)("div",{className:"relative w-full md:w-72",children:[(0,n.jsx)("div",{className:"absolute right-0 top-0 h-full flex items-center pr-2",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{onClick:()=>F(!I),className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors",title:"排序",children:(0,n.jsx)(w,{className:"h-4 w-4"})}),I&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>F(!1)}),(0,n.jsxs)("div",{className:"absolute right-0 mt-2 w-32 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 py-1 z-20 text-sm",children:[(0,n.jsx)("div",{className:"px-3 py-1 text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase",children:"排序方式"}),(0,n.jsx)("button",{onClick:()=>ej("lastModified","desc"),className:"w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("lastModified"===es.key&&"desc"===es.direction?"text-blue-600 font-medium":"text-gray-700 dark:text-gray-200"),children:"时间 (最新)"}),(0,n.jsx)("button",{onClick:()=>ej("lastModified","asc"),className:"w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("lastModified"===es.key&&"asc"===es.direction?"text-blue-600 font-medium":"text-gray-700 dark:text-gray-200"),children:"时间 (最早)"}),(0,n.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-700 my-1"}),(0,n.jsx)("button",{onClick:()=>ej("name","asc"),className:"w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("name"===es.key&&"asc"===es.direction?"text-blue-600 font-medium":"text-gray-700 dark:text-gray-200"),children:"名称 (A-Z)"}),(0,n.jsx)("button",{onClick:()=>ej("name","desc"),className:"w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("name"===es.key&&"desc"===es.direction?"text-blue-600 font-medium":"text-gray-700 dark:text-gray-200"),children:"名称 (Z-A)"}),(0,n.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-700 my-1"}),(0,n.jsx)("button",{onClick:()=>ej("size","asc"),className:"w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("size"===es.key&&"asc"===es.direction?"text-blue-600 font-medium":"text-gray-700 dark:text-gray-200"),children:"大小 (小-大)"}),(0,n.jsx)("button",{onClick:()=>ej("size","desc"),className:"w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("size"===es.key&&"desc"===es.direction?"text-blue-600 font-medium":"text-gray-700 dark:text-gray-200"),children:"大小 (大-小)"})]})]})]})}),(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsxs)("svg",{className:"h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("circle",{cx:"11",cy:"11",r:"7"}),(0,n.jsx)("path",{d:"M21 21l-4.2-4.2",strokeLinecap:"round"})]})}),(0,n.jsx)("input",{type:"text",value:z,onChange:e=>_(e.target.value),className:"block w-full pl-10 pr-10 py-2 border border-gray-200 dark:border-gray-700 rounded-lg leading-5 bg-gray-50 dark:bg-gray-800/50 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:bg-white dark:focus:bg-gray-800 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 sm:text-sm transition-all",placeholder:"搜索文件..."})]})]}),(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden",children:[(0,n.jsxs)("div",{className:"hidden md:grid grid-cols-[minmax(0,3fr)_1fr_1fr_1.5fr] gap-4 px-6 py-3 bg-gray-50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-800 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[(0,n.jsx)("div",{children:"文件名"}),(0,n.jsx)("div",{children:"修改时间"}),(0,n.jsx)("div",{children:"大小"}),(0,n.jsx)("div",{className:"text-right",children:"操作"})]}),0===em.length?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500 dark:text-gray-400",children:[(0,n.jsx)("svg",{className:"h-16 w-16 mb-4 text-gray-300 dark:text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),(0,n.jsx)("p",{className:"text-lg font-medium",children:"暂无文件"}),(0,n.jsx)("p",{className:"text-sm mt-1",children:"当前目录下没有文件或文件夹"})]}):(0,n.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:em.map(e=>{let t=e.item,r=u(t.name,t.type),a="folder"===t.type,s=m(t.url);return(0,n.jsxs)("div",{className:"group flex items-center justify-between gap-3 px-4 py-3 md:grid md:grid-cols-[minmax(0,3fr)_1fr_1fr_1.5fr] md:gap-4 md:px-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors cursor-pointer border-b border-gray-100 dark:border-gray-800 last:border-0",onClick:()=>{if(ex&&a){l(e.fullPath),_("");return}a?ep(t):eg(t)},children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:g(t.name,t.type)}),(0,n.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"truncate text-sm font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:t.name}),(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ".concat(r.tone),children:r.label})]}),(0,n.jsxs)("div",{className:"mt-0.5 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 md:hidden",children:[(0,n.jsx)("span",{children:f(t.lastModified)}),(0,n.jsx)("span",{className:"text-gray-300 dark:text-gray-700",children:"|"}),(0,n.jsx)("span",{children:p(t.size)})]})]})]}),(0,n.jsx)("div",{className:"hidden md:block text-sm text-gray-500 dark:text-gray-400",children:f(t.lastModified)}),(0,n.jsx)("div",{className:"hidden md:block text-sm text-gray-500 dark:text-gray-400",children:p(t.size)}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 flex-shrink-0",onClick:e=>e.stopPropagation(),children:["folder"!==t.type&&s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 ".concat(R===s?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border border-transparent scale-105":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-700 hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:border-blue-500 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 hover:shadow-sm"),onClick:()=>eh(s),title:"复制直链",children:[(0,n.jsx)(y,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"复制直链"})]}),(0,n.jsxs)("a",{href:h(t.url,t.name),download:t.name,className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-500 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",onClick:()=>H("正在拉起下载... \uD83D\uDE80"),title:"下载",children:[(0,n.jsx)(k,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"下载"})]})]}),"folder"===t.type&&(0,n.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},"".concat(e.fullPath.join("/"),":").concat(t.type))})})]}),(0,n.jsx)("footer",{className:"mt-auto py-6 border-t border-gray-200 dark:border-gray-800",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,n.jsxs)("span",{children:["\xa9 ",new Date().getFullYear()," WanQing's R2 Drive."]}),(0,n.jsx)("div",{className:"hidden md:block w-px h-4 bg-gray-300 dark:bg-gray-700"}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{children:"Designed by"}),(0,n.jsx)("a",{href:"https://qinghub.top",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:"WanQing"})]}),(0,n.jsx)("div",{className:"hidden md:block w-px h-4 bg-gray-300 dark:bg-gray-700"}),(0,n.jsx)("a",{href:"https://github.com/wangqing176176-a11y",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",title:"GitHub",children:(0,n.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})})]})})]}),o&&(0,n.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-2 md:p-4",onClick:eu,children:(0,n.jsxs)("div",{className:"relative w-full max-w-6xl h-[70vh] md:h-[90vh] flex flex-col bg-white dark:bg-gray-900 rounded-2xl shadow-2xl overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 z-10 gap-4",children:[(0,n.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,n.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",title:o.name,children:o.name}),(0,n.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[f(o.lastModified)," \xb7 ",p(o.size)]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m(o.url)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 border border-transparent hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:border-blue-500 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 transition-all duration-200",onClick:()=>eh(m(o.url)),children:[(0,n.jsx)(y,{className:"h-5 w-5"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"复制直链"})]}),(0,n.jsxs)("a",{href:h(o.url,o.name),download:o.name,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",onClick:()=>H("正在拉起下载... \uD83D\uDE80"),children:[(0,n.jsx)(k,{className:"h-5 w-5"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"下载"})]})]}),(0,n.jsx)("button",{className:"ml-2 p-2 rounded-full text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",onClick:eu,children:(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-auto bg-gray-100 dark:bg-black flex items-center justify-center p-4",children:[(o.type.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|svg|bmp|ico|tiff)$/i.test(o.name.toLowerCase()))&&(0,n.jsx)("img",{src:m(o.url)||"",alt:o.name,className:"max-w-full max-h-full object-contain rounded-lg shadow-lg"}),(o.type.startsWith("video/")||/\.(mp4|webm|ogg|mov|mkv|avi|m4v)$/i.test(o.name.toLowerCase()))&&(0,n.jsx)("div",{className:"relative w-full max-w-5xl aspect-video bg-black rounded-lg shadow-[0_4px_12px_rgba(0,0,0,0.3)] overflow-hidden mx-auto",style:{maxHeight:"100%"},children:(0,n.jsx)("video",{src:m(o.url)||"",controls:!0,className:"w-full h-full object-contain"})}),(o.type.startsWith("audio/")||/\.(mp3|wav|ogg|m4a|flac|aac|wma)$/i.test(o.name.toLowerCase()))&&(0,n.jsx)("div",{className:"w-full max-w-md mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,n.jsx)("div",{className:"h-16 w-16 bg-cyan-100 dark:bg-cyan-900/30 rounded-full flex items-center justify-center text-cyan-600 dark:text-cyan-400",children:(0,n.jsx)("svg",{className:"h-8 w-8",fill:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M21 3L9 5.5v10.03a3.5 3.5 0 1 0 2 3V8.41l8-1.66v7.78a3.5 3.5 0 1 0 2 3V3z"})})}),(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white text-center break-all",children:o.name}),(0,n.jsx)("audio",{src:m(o.url)||"",controls:!0,className:"w-full"})]})}),"application/pdf"===o.type&&(0,n.jsx)("iframe",{src:m(o.url)||"",className:"w-full h-full bg-white rounded-lg shadow-lg",title:"PDF Preview"}),(o.type.includes("word")||o.type.includes("document")||o.type.includes("sheet")||o.type.includes("excel")||o.type.includes("presentation")||o.type.includes("powerpoint"))&&(0,n.jsx)("iframe",{src:"https://view.officeapps.live.com/op/view.aspx?src=".concat(encodeURIComponent(m(o.url)||"")),className:"w-full h-full bg-white",title:"Office Preview"}),!(o.type.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp|svg|bmp|ico|tiff)$/i.test(o.name.toLowerCase()))&&!(o.type.startsWith("video/")||/\.(mp4|webm|ogg|mov|mkv|avi|m4v)$/i.test(o.name.toLowerCase()))&&!(o.type.startsWith("audio/")||/\.(mp3|wav|ogg|m4a|flac|aac|wma)$/i.test(o.name.toLowerCase()))&&"application/pdf"!==o.type&&!o.type.includes("word")&&!o.type.includes("document")&&!o.type.includes("sheet")&&!o.type.includes("excel")&&!o.type.includes("presentation")&&!o.type.includes("powerpoint")&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center text-center p-8",children:[(0,n.jsx)("div",{className:"h-24 w-24 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:g(o.name,o.type)}),(0,n.jsx)("h3",{className:"text-xl font-medium text-gray-900 dark:text-white mb-2",children:"无法预览此文件"}),(0,n.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"此文件类型暂不支持在线预览，请下载后查看。"}),(0,n.jsxs)("a",{href:h(o.url,o.name),download:o.name,className:"inline-flex items-center gap-2 px-6 py-3 rounded-lg text-base font-medium text-white bg-blue-600 hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md active:scale-95",onClick:()=>H("正在拉起下载... \uD83D\uDE80"),children:[(0,n.jsx)(k,{className:"h-5 w-5"}),"下载文件"]})]})]})]})}),T&&(0,n.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,n.jsxs)("div",{className:"w-full max-w-2xl bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 overflow-hidden flex flex-col max-h-[80vh]",children:[(0,n.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between bg-gray-50 dark:bg-gray-800/50",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"文件上传"}),(0,n.jsx)("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:(0,n.jsx)(Z,{className:"h-5 w-5"})})]}),Q?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mx-6 mt-6 border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center text-center transition-colors ".concat(P?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500"),onDragOver:e=>{e.preventDefault(),D(!0)},onDragLeave:e=>{e.preventDefault(),D(!1)},onDrop:e=>{e.preventDefault(),D(!1);let t=Array.from(e.dataTransfer.files);t.length>0&&eN(t)},children:[(0,n.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-600 dark:text-blue-400 mb-3",children:(0,n.jsx)(j,{className:"h-8 w-8"})}),(0,n.jsxs)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["拖拽文件到此处，或 ",(0,n.jsx)("button",{onClick:()=>{var e;null===(e=en.current)||void 0===e||e.click()},className:"text-blue-600 hover:underline",children:"点击选择"})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"支持多文件上传，单文件最大 5GB"})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-3",children:[0===V.length&&(0,n.jsx)("p",{className:"text-center text-sm text-gray-500 py-4",children:"暂无上传任务"}),V.map(e=>(0,n.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-100 dark:border-gray-800",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:g(e.file.name,e.file.type)}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,n.jsx)("span",{className:"text-sm font-medium truncate max-w-[200px] sm:max-w-xs",title:e.file.name,children:e.file.name}),(0,n.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:"uploading"===e.status?"".concat(Math.round(e.progress),"% \xb7 ").concat(e.speed):p(e.file.size)})]}),"uploading"===e.status&&(0,n.jsx)("div",{className:"h-1.5 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,n.jsx)("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),"error"===e.status&&(0,n.jsx)("p",{className:"text-xs text-red-500 mt-1",children:e.error}),"paused"===e.status&&(0,n.jsx)("p",{className:"text-xs text-orange-500 mt-1",children:"已暂停"}),"pending"===e.status&&(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"等待上传..."})]}),(0,n.jsx)("div",{className:"flex-shrink-0 flex items-center gap-2",children:"success"===e.status?(0,n.jsxs)("span",{className:"text-green-500 text-sm font-medium flex items-center gap-1",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"完成"]}):(0,n.jsxs)(n.Fragment,{children:["uploading"===e.status&&(0,n.jsx)("button",{onClick:()=>ev(e.id),className:"text-gray-400 hover:text-orange-500 p-1",title:"暂停",children:(0,n.jsx)(A,{className:"h-5 w-5"})}),("paused"===e.status||"error"===e.status)&&(0,n.jsx)("button",{onClick:()=>ey(e.id),className:"text-gray-400 hover:text-blue-500 p-1",title:"重试/继续",children:(0,n.jsx)(B,{className:"h-5 w-5"})}),(0,n.jsx)("button",{onClick:()=>ek(e.id),className:"text-gray-400 hover:text-red-500 p-1",title:"取消/删除",children:(0,n.jsx)(W,{className:"h-5 w-5"})})]})})]},e.id))]})]}):(0,n.jsx)("div",{className:"p-8 flex flex-col gap-6 justify-center items-center bg-white dark:bg-gray-900",children:(0,n.jsxs)("div",{className:"w-full max-w-sm space-y-5",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"管理员登录"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"请验证身份以继续上传文件"})]}),K&&(0,n.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm px-4 py-3 rounded-lg flex items-center gap-2 animate-fade-in-up",children:[(0,n.jsx)("svg",{className:"h-5 w-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),K]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"账号"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsx)(N,{className:"h-5 w-5 text-gray-400"})}),(0,n.jsx)("input",{type:"text",placeholder:"请输入管理员账号",value:O,onChange:e=>q(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 focus:bg-white dark:focus:bg-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all text-gray-900 dark:text-white placeholder-gray-400"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"密码"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsx)(C,{className:"h-5 w-5 text-gray-400"})}),(0,n.jsx)("input",{type:er?"text":"password",placeholder:"请输入密码",value:X,onChange:e=>G(e.target.value),className:"w-full pl-10 pr-10 py-2.5 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 focus:bg-white dark:focus:bg-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all text-gray-900 dark:text-white placeholder-gray-400"}),(0,n.jsx)("button",{type:"button",onClick:()=>ea(!er),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors focus:outline-none",tabIndex:-1,children:er?(0,n.jsx)(M,{className:"h-5 w-5"}):(0,n.jsx)(L,{className:"h-5 w-5"})})]})]})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 cursor-pointer select-none group",children:[(0,n.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>et(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 transition-all"}),(0,n.jsx)("span",{className:"group-hover:text-gray-900 dark:group-hover:text-gray-200 transition-colors",children:"记住登录信息"})]})}),(0,n.jsx)("button",{onClick:()=>{O===c&&X===x?(J(!0),Y(""),ee?localStorage.setItem("r2_username",O):localStorage.removeItem("r2_username")):Y("账号或密码错误，请重试")},className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all shadow-sm hover:shadow-md active:scale-[0.98] flex items-center justify-center gap-2",children:"登录"})]})})]})}),E&&(0,n.jsx)("div",{className:"fixed bottom-6 right-6 z-[200] max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4 animate-fade-in-up",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-200",children:E}),(0,n.jsx)("button",{className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>H(null),children:(0,n.jsx)("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,n.jsx)("input",{ref:en,type:"file",multiple:!0,className:"hidden",onChange:ew})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(403)),_N_E=e.O()}]);